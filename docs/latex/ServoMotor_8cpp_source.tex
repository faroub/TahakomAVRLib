\hypertarget{ServoMotor_8cpp_source}{}\doxysection{Servo\+Motor.\+cpp}
\label{ServoMotor_8cpp_source}\index{ServoMotor.cpp@{ServoMotor.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{ServoMotor_8h}{ServoMotor.h}}"}}
\DoxyCodeLine{00002 }
\DoxyCodeLine{00003 }
\DoxyCodeLine{00004 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00005}\mbox{\hyperlink{classcomponent_1_1ServoMotor_ab895cb74efe648cc1ea71bc6b97b5311}{00005}} \mbox{\hyperlink{classcomponent_1_1ServoMotor_ab895cb74efe648cc1ea71bc6b97b5311}{component::ServoMotor::ServoMotor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classio_1_1Pin}{io::Pin}} \&ar\_pin,}
\DoxyCodeLine{00006                                   \textcolor{keyword}{const} uint16\_t \&ar\_pulseCycle,}
\DoxyCodeLine{00007                                   \textcolor{keyword}{const} uint16\_t \&ar\_pulseWidthMin,}
\DoxyCodeLine{00008                                   \textcolor{keyword}{const} uint16\_t \&ar\_pulseWidthMid,}
\DoxyCodeLine{00009                                   \textcolor{keyword}{const} uint16\_t \&ar\_pulseWidthMax)}
\DoxyCodeLine{00010                       : m\_pin(ar\_pin),}
\DoxyCodeLine{00011                         m\_pulseCycle(ar\_pulseCycle),}
\DoxyCodeLine{00012                         m\_pulseWidthMin(ar\_pulseWidthMin),}
\DoxyCodeLine{00013                         m\_pulseWidthMid(ar\_pulseWidthMid),}
\DoxyCodeLine{00014                         m\_pulseWidthMax(ar\_pulseWidthMax)}
\DoxyCodeLine{00015 \{}
\DoxyCodeLine{00016     \mbox{\hyperlink{classcomponent_1_1ServoMotor_a6bcab716acd4f99ad73b2c3fe1fa7b26}{m\_pin}}.\mbox{\hyperlink{classio_1_1Pin_a2d1e7ed9625d0c4bb8d81dadbadacc41}{toOutput}}();}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018 \}}
\DoxyCodeLine{00019 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00020}\mbox{\hyperlink{classcomponent_1_1ServoMotor_af7a59467a84914222a20952493ee3f82}{00020}} \mbox{\hyperlink{classcomponent_1_1ServoMotor_af7a59467a84914222a20952493ee3f82}{component::ServoMotor::\string~ServoMotor}}()}
\DoxyCodeLine{00021 \{}
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 \}}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025 }
\DoxyCodeLine{00026 }
\DoxyCodeLine{00027 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00028}\mbox{\hyperlink{classcomponent_1_1ServoMotor_a80764da2073f145027acb0e5c8a2a522}{00028}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_a80764da2073f145027acb0e5c8a2a522}{component::ServoMotor::on}}()}
\DoxyCodeLine{00029 \{}
\DoxyCodeLine{00030     m\_pin.setHigh();}
\DoxyCodeLine{00031 \}}
\DoxyCodeLine{00032 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00033}\mbox{\hyperlink{classcomponent_1_1ServoMotor_aed98821dc8a130ac42e29b09dbd9948b}{00033}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_aed98821dc8a130ac42e29b09dbd9948b}{component::ServoMotor::off}}()}
\DoxyCodeLine{00034 \{}
\DoxyCodeLine{00035     m\_pin.setLow();}
\DoxyCodeLine{00036 \}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00038}\mbox{\hyperlink{classcomponent_1_1ServoMotor_a45d22d89695730f6377b6532fc291428}{00038}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_a45d22d89695730f6377b6532fc291428}{component::ServoMotor::toggle}}()}
\DoxyCodeLine{00039 \{}
\DoxyCodeLine{00040     m\_pin.toggle();}
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042 \}}
\DoxyCodeLine{00043 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00044}\mbox{\hyperlink{classcomponent_1_1ServoMotor_a1abbbd945b76c3cee6e01f2ea3cf91dd}{00044}} uint16\_t \mbox{\hyperlink{classcomponent_1_1ServoMotor_a1abbbd945b76c3cee6e01f2ea3cf91dd}{component::ServoMotor::computePulseCycleCount}}(\textcolor{keyword}{const} uint16\_t \&ar\_clockPrescaler)}
\DoxyCodeLine{00045 \{}
\DoxyCodeLine{00046     \textcolor{keywordflow}{return} \mbox{\hyperlink{ha__m328p_8h_ac06ca117a692a02dcd520cf0f44338d8}{SERVOMOTOR\_TIMER\_PULSE\_WIDTH\_COUNT}}(m\_pulseCycle,ar\_clockPrescaler);}
\DoxyCodeLine{00047 \}}
\DoxyCodeLine{00048 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00049}\mbox{\hyperlink{classcomponent_1_1ServoMotor_a42cecd2df4dad95fa5065a38fa97ca56}{00049}} uint16\_t \mbox{\hyperlink{classcomponent_1_1ServoMotor_a42cecd2df4dad95fa5065a38fa97ca56}{component::ServoMotor::computePulseWidthMinCount}}(\textcolor{keyword}{const} uint16\_t \&ar\_clockPrescaler)}
\DoxyCodeLine{00050 \{}
\DoxyCodeLine{00051     \textcolor{keywordflow}{return} \mbox{\hyperlink{ha__m328p_8h_ac06ca117a692a02dcd520cf0f44338d8}{SERVOMOTOR\_TIMER\_PULSE\_WIDTH\_COUNT}}(m\_pulseWidthMin,ar\_clockPrescaler);}
\DoxyCodeLine{00052 \}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00054}\mbox{\hyperlink{classcomponent_1_1ServoMotor_aaf0e4b971867acb8678abf79f69ddfbd}{00054}} uint16\_t \mbox{\hyperlink{classcomponent_1_1ServoMotor_aaf0e4b971867acb8678abf79f69ddfbd}{component::ServoMotor::computePulseWidthMaxCount}}(\textcolor{keyword}{const} uint16\_t \&ar\_clockPrescaler)}
\DoxyCodeLine{00055 \{}
\DoxyCodeLine{00056     \textcolor{keywordflow}{return} \mbox{\hyperlink{ha__m328p_8h_ac06ca117a692a02dcd520cf0f44338d8}{SERVOMOTOR\_TIMER\_PULSE\_WIDTH\_COUNT}}(m\_pulseWidthMax,ar\_clockPrescaler);}
\DoxyCodeLine{00057 \}}
\DoxyCodeLine{00058 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00059}\mbox{\hyperlink{classcomponent_1_1ServoMotor_aedc67b647bd299afbe52205d82d0c69e}{00059}} uint16\_t \mbox{\hyperlink{classcomponent_1_1ServoMotor_aedc67b647bd299afbe52205d82d0c69e}{component::ServoMotor::computePulseWidthMidCount}}(\textcolor{keyword}{const} uint16\_t \&ar\_clockPrescaler)}
\DoxyCodeLine{00060 \{}
\DoxyCodeLine{00061     \textcolor{keywordflow}{return} \mbox{\hyperlink{ha__m328p_8h_ac06ca117a692a02dcd520cf0f44338d8}{SERVOMOTOR\_TIMER\_PULSE\_WIDTH\_COUNT}}(m\_pulseWidthMid,ar\_clockPrescaler);}
\DoxyCodeLine{00062 \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00064}\mbox{\hyperlink{classcomponent_1_1ServoMotor_a76437de03912f97801b0f067a290608f}{00064}} uint16\_t \mbox{\hyperlink{classcomponent_1_1ServoMotor_a76437de03912f97801b0f067a290608f}{component::ServoMotor::computeRotationAngleCount}}(\textcolor{keyword}{const} uint8\_t \&ar\_angle\_deg,\textcolor{keyword}{const} uint16\_t \&ar\_clockPrescaler)}
\DoxyCodeLine{00065 \{}
\DoxyCodeLine{00066     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}uint16\_t\textcolor{keyword}{>}(\mbox{\hyperlink{ha__m328p_8h_ac9712b0006fe45b09f1dfefaa8ed9b78}{SERVOMOTOR\_TIMER\_ANGLE\_COUNT}}(ar\_angle\_deg,\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{long}\textcolor{keyword}{>}(computePulseWidthMinCount(ar\_clockPrescaler)),\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{long}\textcolor{keyword}{>}(computePulseWidthMidCount(ar\_clockPrescaler)),\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{long}\textcolor{keyword}{>}(computePulseWidthMaxCount(ar\_clockPrescaler))));}
\DoxyCodeLine{00067 \}}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00071}\mbox{\hyperlink{classcomponent_1_1ServoMotor_af851f56f5e4ae7cd70818e87e334047d}{00071}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_af851f56f5e4ae7cd70818e87e334047d}{component::ServoMotor::rotate}}(\mbox{\hyperlink{classcore_1_1TimerCounter1}{core::TimerCounter1}} \&ar\_timerCounter1,}
\DoxyCodeLine{00072                                    \textcolor{keyword}{const} uint8\_t \&ar\_angle\_deg,}
\DoxyCodeLine{00073                                    \textcolor{keyword}{const} \mbox{\hyperlink{namespacecore_a1bbe9e05be92da10bbb8ef7805df1419}{core::channel}} \&ar\_channel)}
\DoxyCodeLine{00074 \{}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a80fd69004f5e154dd7f20741863306e2}{setOutputCompareRegister}}(ar\_channel, computeRotationAngleCount(ar\_angle\_deg,ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a4acdbf18d86748032abf6f07e7a6d9b1}{getClockPrescaler}}()));}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078     \textcolor{comment}{// start timer}}
\DoxyCodeLine{00079     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_ad6322d60b67dce323aa7952fd9923040}{start}}();}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081 }
\DoxyCodeLine{00082 \}}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00085}\mbox{\hyperlink{classcomponent_1_1ServoMotor_ac6fc14796b51b3bcd02b4e08cd5dad86}{00085}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_ac6fc14796b51b3bcd02b4e08cd5dad86}{component::ServoMotor::connect}}(\mbox{\hyperlink{classcore_1_1TimerCounter1}{core::TimerCounter1}} \&ar\_timerCounter1,}
\DoxyCodeLine{00086              \textcolor{keyword}{const} \mbox{\hyperlink{namespacecore_a1bbe9e05be92da10bbb8ef7805df1419}{core::channel}} \&ar\_channel)}
\DoxyCodeLine{00087 \{}
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_aa3688ece97a8ffce5d65132f5a885bea}{setInputCaptureRegister}}(computePulseCycleCount(ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a4acdbf18d86748032abf6f07e7a6d9b1}{getClockPrescaler}}()));}
\DoxyCodeLine{00091     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a09071abf6d7f6a99216bf3735a94df0e}{selectOperationMode}}(\mbox{\hyperlink{namespacecore_a5fa1c13ba2de3f8eacf4d56627b359b4afc3f15b740f731d2d2ef7d32fac6d071}{core::operationMode::fast\_PWM\_ICR}});}
\DoxyCodeLine{00092     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a663221dc1a1b1d04c2aa06dec2a6bb72}{selectCompareOutputMode}}(ar\_channel, \mbox{\hyperlink{namespacecore_abf164abe46881599e64640a064d89950a01bc6f8efa4202821e95f4fdf6298b30}{core::compareOutputMode::clear}});}
\DoxyCodeLine{00093     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a80b34086ae7fc68a693e26ea9400a892}{setCounter}}(0);}
\DoxyCodeLine{00094 }
\DoxyCodeLine{00095 \}}
\DoxyCodeLine{00096 }
\DoxyCodeLine{\Hypertarget{ServoMotor_8cpp_source_l00097}\mbox{\hyperlink{classcomponent_1_1ServoMotor_afac8050d859c484ad104fbf9ecf9cbac}{00097}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1ServoMotor_afac8050d859c484ad104fbf9ecf9cbac}{component::ServoMotor::disconnect}}(\mbox{\hyperlink{classcore_1_1TimerCounter1}{core::TimerCounter1}} \&ar\_timerCounter1,}
\DoxyCodeLine{00098                 \textcolor{keyword}{const} \mbox{\hyperlink{namespacecore_a1bbe9e05be92da10bbb8ef7805df1419}{core::channel}} \&ar\_channel)}
\DoxyCodeLine{00099 \{}
\DoxyCodeLine{00100     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a663221dc1a1b1d04c2aa06dec2a6bb72}{selectCompareOutputMode}}(ar\_channel, \mbox{\hyperlink{namespacecore_abf164abe46881599e64640a064d89950afea087517c26fadd409bd4b9dc642555}{core::compareOutputMode::normal}});}
\DoxyCodeLine{00101     \textcolor{comment}{// stop timer}}
\DoxyCodeLine{00102     ar\_timerCounter1.\mbox{\hyperlink{classcore_1_1TimerCounter1_a2604e3b9ee815ce34876da9c09db840d}{stop}}();}
\DoxyCodeLine{00103 \}}

\end{DoxyCode}
