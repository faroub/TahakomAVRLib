\hypertarget{StepperMotor_8cpp_source}{}\doxysection{Stepper\+Motor.\+cpp}
\label{StepperMotor_8cpp_source}\index{StepperMotor.cpp@{StepperMotor.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{StepperMotor_8h}{StepperMotor.h}}"}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{00003 }
\DoxyCodeLine{00004 \textcolor{comment}{// TODO: steps to angle}}
\DoxyCodeLine{00005 \textcolor{comment}{// TODO: maximum speed}}
\DoxyCodeLine{00006 \textcolor{comment}{// TODO: speed and accelleration profiles}}
\DoxyCodeLine{00007 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00008}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a925f980b35109479233b328ddb176d25}{00008}} \mbox{\hyperlink{classcomponent_1_1StepperMotor_a925f980b35109479233b328ddb176d25}{component::StepperMotor::StepperMotor}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52b}{mode}} \&ar\_mode,}
\DoxyCodeLine{00009                                       \textcolor{keyword}{const} \mbox{\hyperlink{classio_1_1Pin}{io::Pin}} \&ar\_pinCoil1,}
\DoxyCodeLine{00010                                       \textcolor{keyword}{const} \mbox{\hyperlink{classio_1_1Pin}{io::Pin}} \&ar\_pinCoil2,}
\DoxyCodeLine{00011                                       \textcolor{keyword}{const} \mbox{\hyperlink{classio_1_1Pin}{io::Pin}} \&ar\_pinCoil3,}
\DoxyCodeLine{00012                                       \textcolor{keyword}{const} \mbox{\hyperlink{classio_1_1Pin}{io::Pin}} \&ar\_pinCoil4)}
\DoxyCodeLine{00013     : m\_pinCoil1(ar\_pinCoil1),}
\DoxyCodeLine{00014       m\_pinCoil2(ar\_pinCoil2),}
\DoxyCodeLine{00015       m\_pinCoil3(ar\_pinCoil3),}
\DoxyCodeLine{00016       m\_pinCoil4(ar\_pinCoil4),}
\DoxyCodeLine{00017       stepMode(ar\_mode)}
\DoxyCodeLine{00018 \{}
\DoxyCodeLine{00019 }
\DoxyCodeLine{00020     \mbox{\hyperlink{classcomponent_1_1StepperMotor_ad002171b022f00ca17861d71d75bd015}{m\_pinCoil1}}.\mbox{\hyperlink{classio_1_1Pin_a2d1e7ed9625d0c4bb8d81dadbadacc41}{toOutput}}();}
\DoxyCodeLine{00021     \mbox{\hyperlink{classcomponent_1_1StepperMotor_a8840acea5cf9c52489b9c228d1920b61}{m\_pinCoil2}}.\mbox{\hyperlink{classio_1_1Pin_a2d1e7ed9625d0c4bb8d81dadbadacc41}{toOutput}}();}
\DoxyCodeLine{00022     \mbox{\hyperlink{classcomponent_1_1StepperMotor_af5069e24b79f04abd10b988fce8bee8f}{m\_pinCoil3}}.\mbox{\hyperlink{classio_1_1Pin_a2d1e7ed9625d0c4bb8d81dadbadacc41}{toOutput}}();}
\DoxyCodeLine{00023     \mbox{\hyperlink{classcomponent_1_1StepperMotor_a65bb1a27f14916e49ccee2bdfb94c4cf}{m\_pinCoil4}}.\mbox{\hyperlink{classio_1_1Pin_a2d1e7ed9625d0c4bb8d81dadbadacc41}{toOutput}}();}
\DoxyCodeLine{00024     \mbox{\hyperlink{classcomponent_1_1StepperMotor_aa1cfa2053a4c578b19c4f823b44a6797}{m\_goalReached}} = 0;}
\DoxyCodeLine{00025     \mbox{\hyperlink{classcomponent_1_1StepperMotor_a8304f53f95cac4661ef191fccd7e02bf}{m\_currentPos}} = 0;}
\DoxyCodeLine{00026 }
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028 \}}
\DoxyCodeLine{00029 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00030}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a913f3fc25e9436367f0c5b54f9f2339d}{00030}} \mbox{\hyperlink{classcomponent_1_1StepperMotor_a913f3fc25e9436367f0c5b54f9f2339d}{component::StepperMotor::\string~StepperMotor}}()}
\DoxyCodeLine{00031 \{}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033 \}}
\DoxyCodeLine{00034 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00035}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a3de879c4f56f597f1533c844df4f0ab2}{00035}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_a3de879c4f56f597f1533c844df4f0ab2}{component::StepperMotor::setCurrentPos}}(uint16\_t a\_currentPos)}
\DoxyCodeLine{00036 \{}
\DoxyCodeLine{00037     m\_currentPos = a\_currentPos;}
\DoxyCodeLine{00038 \}}
\DoxyCodeLine{00039 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00040}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a887bc608b8e60540a6b1bc0e75e5d570}{00040}} uint16\_t \mbox{\hyperlink{classcomponent_1_1StepperMotor_a887bc608b8e60540a6b1bc0e75e5d570}{component::StepperMotor::currentPos}}()}
\DoxyCodeLine{00041 \{}
\DoxyCodeLine{00042     \textcolor{keywordflow}{return} m\_currentPos;}
\DoxyCodeLine{00043 \}}
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00047}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a3492cb58c077c9297a7022e61a3025c3}{00047}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_ac60d9098f34251fbea85b672f6ef8d89}{component::StepperMotor::step}}(\textcolor{keyword}{const} int16\_t a\_step,}
\DoxyCodeLine{00048         \textcolor{keyword}{const} uint16\_t a\_speed,}
\DoxyCodeLine{00049         \textcolor{keyword}{const} uint16\_t a\_accel,}
\DoxyCodeLine{00050         \textcolor{keyword}{const} uint16\_t a\_decel)}
\DoxyCodeLine{00051 \{}
\DoxyCodeLine{00052     \textcolor{keyword}{static} int16\_t l\_stepNumber = 0;}
\DoxyCodeLine{00053     uint8\_t l\_stepDelay\_ms = 0;}
\DoxyCodeLine{00054     uint16\_t l\_step=0;}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056     \textcolor{keywordflow}{if} (a\_step<=0)}
\DoxyCodeLine{00057     \{}
\DoxyCodeLine{00058        l\_step = -\/a\_step;}
\DoxyCodeLine{00059     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{00060     \{}
\DoxyCodeLine{00061         l\_step = a\_step;}
\DoxyCodeLine{00062     \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064     l\_stepDelay\_ms = computeStepDelay(l\_step,}
\DoxyCodeLine{00065                                       a\_speed,}
\DoxyCodeLine{00066                                       a\_accel,}
\DoxyCodeLine{00067                                       a\_decel);}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069 \textcolor{keywordflow}{if} (l\_stepDelay\_ms>0)}
\DoxyCodeLine{00070 \{}
\DoxyCodeLine{00071     }
\DoxyCodeLine{00072     \textcolor{keywordflow}{if} (a\_step<=0)}
\DoxyCodeLine{00073     \{}
\DoxyCodeLine{00074         \textcolor{keywordflow}{if} (l\_stepNumber== -\/a\_step)}
\DoxyCodeLine{00075         \{}
\DoxyCodeLine{00076             m\_goalReached = 1;}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00079             l\_stepNumber++;}
\DoxyCodeLine{00080             m\_currentPos++;}
\DoxyCodeLine{00081         \}}
\DoxyCodeLine{00082 }
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086         \textcolor{keywordflow}{if} (l\_stepNumber == -\/a\_step)}
\DoxyCodeLine{00087         \{}
\DoxyCodeLine{00088             m\_goalReached = 1;}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00091             l\_stepNumber-\/-\/;}
\DoxyCodeLine{00092             m\_currentPos-\/-\/;}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094         \}}
\DoxyCodeLine{00095     \}}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097 }
\DoxyCodeLine{00098     \textcolor{keywordflow}{if} (m\_goalReached == 0)}
\DoxyCodeLine{00099     \{}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101         \textcolor{keywordflow}{switch} (stepMode)}
\DoxyCodeLine{00102         \{}
\DoxyCodeLine{00103             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52bab01b1ee8c2821e707be5cbfb22c40cfa}{mode::fullStep}}:}
\DoxyCodeLine{00104             \{}
\DoxyCodeLine{00105                 \textcolor{comment}{// equivalent to l\_stepNumber \% 4}}
\DoxyCodeLine{00106                 \textcolor{comment}{// 1 3 5 7 <-\/>}}
\DoxyCodeLine{00107                 stepPulse(2*(l\_stepNumber \& 3)+1);}
\DoxyCodeLine{00108                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00109             \}}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52ba8b8f0c3e7c9da9a6fc85fac970b41a7b}{mode::halfStep}}:}
\DoxyCodeLine{00112             \{}
\DoxyCodeLine{00113                 \textcolor{comment}{// equivalent to l\_stepNumber \% 8}}
\DoxyCodeLine{00114                 \textcolor{comment}{// 0 1 2 3 4 5 6 7 <-\/>}}
\DoxyCodeLine{00115                 stepPulse(l\_stepNumber \& 7);}
\DoxyCodeLine{00116                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00117             \}}
\DoxyCodeLine{00118         \}}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120         stepDelay(l\_stepDelay\_ms);}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122     \}}
\DoxyCodeLine{00123 \}}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125 \}}
\DoxyCodeLine{00126 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00127}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a9c24c234a9fb776fd9018f7df20b00e8}{00127}} uint8\_t \mbox{\hyperlink{classcomponent_1_1StepperMotor_a9c24c234a9fb776fd9018f7df20b00e8}{component::StepperMotor::computeStepDelay}}(uint16\_t a\_step,}
\DoxyCodeLine{00128                        uint16\_t a\_speed,}
\DoxyCodeLine{00129                        uint16\_t a\_accel,}
\DoxyCodeLine{00130                        uint16\_t a\_decel)}
\DoxyCodeLine{00131 \{}
\DoxyCodeLine{00132 }
\DoxyCodeLine{00133 }
\DoxyCodeLine{00134    uint32\_t l\_accelTime= (1000UL*a\_speed/a\_accel);}
\DoxyCodeLine{00135    uint16\_t l\_decelTime = (1000UL*a\_speed/a\_decel);}
\DoxyCodeLine{00136    int16\_t l\_constSpeedTime=((1000UL*a\_step/a\_speed)-\/(l\_accelTime/2)-\/(l\_decelTime/2));}
\DoxyCodeLine{00137    \textcolor{keyword}{static} uint32\_t l\_time=0;}
\DoxyCodeLine{00138    \textcolor{keyword}{static} uint32\_t l\_speed=0;}
\DoxyCodeLine{00139    \textcolor{keyword}{static} uint64\_t l\_speed\_time\_product=0;}
\DoxyCodeLine{00140    \textcolor{keyword}{static} uint64\_t l\_current\_position=0;}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144 }
\DoxyCodeLine{00145 }
\DoxyCodeLine{00146 }
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148    \textcolor{keywordflow}{if} (l\_constSpeedTime<0)}
\DoxyCodeLine{00149    \{}
\DoxyCodeLine{00150        l\_constSpeedTime=0;}
\DoxyCodeLine{00151        l\_accelTime = \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1000UL*sqrtf(a\_step/a\_accel));}
\DoxyCodeLine{00152        a\_speed=l\_accelTime*a\_accel/1000UL;}
\DoxyCodeLine{00153        l\_decelTime = 1000UL*a\_speed/a\_decel;}
\DoxyCodeLine{00154 }
\DoxyCodeLine{00155    \}}
\DoxyCodeLine{00156 }
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159 }
\DoxyCodeLine{00160    \textcolor{keywordflow}{if} (l\_time<=l\_accelTime)}
\DoxyCodeLine{00161    \{}
\DoxyCodeLine{00162        l\_speed=a\_accel*l\_time;}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164    \}}
\DoxyCodeLine{00165    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((l\_time>l\_accelTime) \&\& (l\_time<=(l\_accelTime+l\_constSpeedTime)))}
\DoxyCodeLine{00166    \{}
\DoxyCodeLine{00167         l\_speed=1000UL*a\_speed;}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169    \}}
\DoxyCodeLine{00170    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((l\_time>(l\_accelTime+l\_constSpeedTime))\&\&(l\_time<=l\_accelTime+l\_constSpeedTime+l\_decelTime))}
\DoxyCodeLine{00171    \{}
\DoxyCodeLine{00172        l\_speed= (1000UL*a\_speed)-\/a\_decel*(l\_time-\/l\_accelTime-\/l\_constSpeedTime);}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174 }
\DoxyCodeLine{00175    \}}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177 }
\DoxyCodeLine{00178    l\_time=l\_time+1;}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180 }
\DoxyCodeLine{00181    l\_speed\_time\_product = l\_speed\_time\_product+l\_speed;}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183    \textcolor{keywordflow}{if} (l\_speed\_time\_product -\/ l\_current\_position >= 1000000UL)}
\DoxyCodeLine{00184    \{}
\DoxyCodeLine{00185        l\_current\_position=l\_current\_position+1000000UL;}
\DoxyCodeLine{00186        \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{00187    \}}
\DoxyCodeLine{00188    \textcolor{keywordflow}{else}}
\DoxyCodeLine{00189    \{}
\DoxyCodeLine{00190        stepDelay(1);}
\DoxyCodeLine{00191        \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00192    \}}
\DoxyCodeLine{00193 }
\DoxyCodeLine{00194 }
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196  }
\DoxyCodeLine{00197     }
\DoxyCodeLine{00198 \}}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00201}\mbox{\hyperlink{classcomponent_1_1StepperMotor_ac60d9098f34251fbea85b672f6ef8d89}{00201}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_ac60d9098f34251fbea85b672f6ef8d89}{component::StepperMotor::step}}(\textcolor{keyword}{const} int16\_t a\_step, \textcolor{keyword}{const} uint16\_t a\_speed)}
\DoxyCodeLine{00202 \{}
\DoxyCodeLine{00203     \textcolor{keyword}{static} int16\_t l\_stepNumber = 0;}
\DoxyCodeLine{00204     \textcolor{keyword}{static} uint8\_t l\_stepDelay\_ms = \textcolor{keyword}{static\_cast<}uint8\_t\textcolor{keyword}{>}(1000UL/a\_speed);}
\DoxyCodeLine{00205 }
\DoxyCodeLine{00206     \textcolor{keywordflow}{if} (a\_step<=0)}
\DoxyCodeLine{00207     \{}
\DoxyCodeLine{00208         \textcolor{keywordflow}{if} (l\_stepNumber== -\/a\_step)}
\DoxyCodeLine{00209         \{}
\DoxyCodeLine{00210             m\_goalReached = 1;}
\DoxyCodeLine{00211 }
\DoxyCodeLine{00212         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00213             l\_stepNumber++;}
\DoxyCodeLine{00214             m\_currentPos++;}
\DoxyCodeLine{00215         \}}
\DoxyCodeLine{00216 }
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220         \textcolor{keywordflow}{if} (l\_stepNumber == -\/a\_step)}
\DoxyCodeLine{00221         \{}
\DoxyCodeLine{00222             m\_goalReached = 1;}
\DoxyCodeLine{00223 }
\DoxyCodeLine{00224         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00225             l\_stepNumber-\/-\/;}
\DoxyCodeLine{00226             m\_currentPos-\/-\/;}
\DoxyCodeLine{00227 }
\DoxyCodeLine{00228         \}}
\DoxyCodeLine{00229     \}}
\DoxyCodeLine{00230 }
\DoxyCodeLine{00231 }
\DoxyCodeLine{00232     \textcolor{keywordflow}{if} (m\_goalReached == 0)}
\DoxyCodeLine{00233     \{}
\DoxyCodeLine{00234 }
\DoxyCodeLine{00235         \textcolor{keywordflow}{switch} (stepMode)}
\DoxyCodeLine{00236         \{}
\DoxyCodeLine{00237             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52bab01b1ee8c2821e707be5cbfb22c40cfa}{mode::fullStep}}:}
\DoxyCodeLine{00238             \{}
\DoxyCodeLine{00239                 \textcolor{comment}{// equivalent to l\_stepNumber \% 4}}
\DoxyCodeLine{00240                 \textcolor{comment}{// 1 3 5 7 <-\/>}}
\DoxyCodeLine{00241                 stepPulse(2*(l\_stepNumber \& 3)+1);}
\DoxyCodeLine{00242                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00243             \}}
\DoxyCodeLine{00244 }
\DoxyCodeLine{00245             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52ba8b8f0c3e7c9da9a6fc85fac970b41a7b}{mode::halfStep}}:}
\DoxyCodeLine{00246             \{}
\DoxyCodeLine{00247                 \textcolor{comment}{// equivalent to l\_stepNumber \% 8}}
\DoxyCodeLine{00248                 \textcolor{comment}{// 0 1 2 3 4 5 6 7 <-\/>}}
\DoxyCodeLine{00249                 stepPulse(l\_stepNumber \& 7);}
\DoxyCodeLine{00250                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00251             \}}
\DoxyCodeLine{00252         \}}
\DoxyCodeLine{00253 }
\DoxyCodeLine{00254         stepDelay(l\_stepDelay\_ms);}
\DoxyCodeLine{00255 }
\DoxyCodeLine{00256     \}}
\DoxyCodeLine{00257 \}}
\DoxyCodeLine{00258 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00259}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a1e4479cb012a8b183e10f2acb826d8d3}{00259}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_ac60d9098f34251fbea85b672f6ef8d89}{component::StepperMotor::step}}(\textcolor{keyword}{const} int16\_t a\_step, \textcolor{keyword}{const} uint16\_t a\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{float} a\_stepAngle)}
\DoxyCodeLine{00260 \{}
\DoxyCodeLine{00261     \textcolor{keyword}{static} int16\_t l\_stepNumber = 0;}
\DoxyCodeLine{00262     \textcolor{keyword}{static} uint8\_t l\_stepDelay\_ms = \textcolor{keyword}{static\_cast<}uint8\_t\textcolor{keyword}{>}(1000UL*a\_stepAngle/a\_speed);}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264     \textcolor{keywordflow}{if} (a\_step<=0)}
\DoxyCodeLine{00265     \{}
\DoxyCodeLine{00266         \textcolor{keywordflow}{if} (l\_stepNumber== -\/a\_step)}
\DoxyCodeLine{00267         \{}
\DoxyCodeLine{00268             m\_goalReached = 1;}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00271             l\_stepNumber++;}
\DoxyCodeLine{00272             m\_currentPos++;}
\DoxyCodeLine{00273         \}}
\DoxyCodeLine{00274 }
\DoxyCodeLine{00275 }
\DoxyCodeLine{00276     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00277 }
\DoxyCodeLine{00278         \textcolor{keywordflow}{if} (l\_stepNumber == -\/a\_step)}
\DoxyCodeLine{00279         \{}
\DoxyCodeLine{00280             m\_goalReached = 1;}
\DoxyCodeLine{00281 }
\DoxyCodeLine{00282         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00283             l\_stepNumber-\/-\/;}
\DoxyCodeLine{00284             m\_currentPos-\/-\/;}
\DoxyCodeLine{00285 }
\DoxyCodeLine{00286         \}}
\DoxyCodeLine{00287     \}}
\DoxyCodeLine{00288 }
\DoxyCodeLine{00289 }
\DoxyCodeLine{00290     \textcolor{keywordflow}{if} (m\_goalReached == 0)}
\DoxyCodeLine{00291     \{}
\DoxyCodeLine{00292 }
\DoxyCodeLine{00293         \textcolor{keywordflow}{switch} (stepMode)}
\DoxyCodeLine{00294         \{}
\DoxyCodeLine{00295             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52bab01b1ee8c2821e707be5cbfb22c40cfa}{mode::fullStep}}:}
\DoxyCodeLine{00296             \{}
\DoxyCodeLine{00297                 \textcolor{comment}{// equivalent to l\_stepNumber \% 4}}
\DoxyCodeLine{00298                 \textcolor{comment}{// 1 3 5 7 <-\/>}}
\DoxyCodeLine{00299                 stepPulse(2*(l\_stepNumber \& 3)+1);}
\DoxyCodeLine{00300                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00301             \}}
\DoxyCodeLine{00302 }
\DoxyCodeLine{00303             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecomponent_af0a0265c4acf2fdab273cd03d0a2b52ba8b8f0c3e7c9da9a6fc85fac970b41a7b}{mode::halfStep}}:}
\DoxyCodeLine{00304             \{}
\DoxyCodeLine{00305                 \textcolor{comment}{// equivalent to l\_stepNumber \% 8}}
\DoxyCodeLine{00306                 \textcolor{comment}{// 0 1 2 3 4 5 6 7 <-\/>}}
\DoxyCodeLine{00307                 stepPulse(l\_stepNumber \& 7);}
\DoxyCodeLine{00308                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{00309             \}}
\DoxyCodeLine{00310         \}}
\DoxyCodeLine{00311 }
\DoxyCodeLine{00312         stepDelay(l\_stepDelay\_ms);}
\DoxyCodeLine{00313 }
\DoxyCodeLine{00314     \}}
\DoxyCodeLine{00315 }
\DoxyCodeLine{00316 }
\DoxyCodeLine{00317 \}}
\DoxyCodeLine{00318 }
\DoxyCodeLine{00319 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00320}\mbox{\hyperlink{classcomponent_1_1StepperMotor_ad5af36b1782d60a2e7e1b5f15688cd57}{00320}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_ad5af36b1782d60a2e7e1b5f15688cd57}{component::StepperMotor::stepPulse}}(\textcolor{keyword}{const} uint8\_t a\_stepPulse)}
\DoxyCodeLine{00321 \{}
\DoxyCodeLine{00322 }
\DoxyCodeLine{00323     \textcolor{keywordflow}{switch} (a\_stepPulse) \{}
\DoxyCodeLine{00324       \textcolor{keywordflow}{case} 0:    \textcolor{comment}{// 1000}}
\DoxyCodeLine{00325       \{}
\DoxyCodeLine{00326         m\_pinCoil1.setHigh();}
\DoxyCodeLine{00327         m\_pinCoil2.setLow();}
\DoxyCodeLine{00328         m\_pinCoil3.setLow();}
\DoxyCodeLine{00329         m\_pinCoil4.setLow();}
\DoxyCodeLine{00330         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00331       \}}
\DoxyCodeLine{00332       \textcolor{keywordflow}{case} 1:    \textcolor{comment}{// 1100}}
\DoxyCodeLine{00333       \{}
\DoxyCodeLine{00334         m\_pinCoil1.setHigh();}
\DoxyCodeLine{00335         m\_pinCoil2.setHigh();}
\DoxyCodeLine{00336         m\_pinCoil3.setLow();}
\DoxyCodeLine{00337         m\_pinCoil4.setLow();}
\DoxyCodeLine{00338         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00339       \}}
\DoxyCodeLine{00340       \textcolor{keywordflow}{case} 2:    \textcolor{comment}{//0100}}
\DoxyCodeLine{00341       \{}
\DoxyCodeLine{00342         m\_pinCoil1.setLow();}
\DoxyCodeLine{00343         m\_pinCoil2.setHigh();}
\DoxyCodeLine{00344         m\_pinCoil3.setLow();}
\DoxyCodeLine{00345         m\_pinCoil4.setLow();}
\DoxyCodeLine{00346         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00347       \}}
\DoxyCodeLine{00348       \textcolor{keywordflow}{case} 3:    \textcolor{comment}{//0110}}
\DoxyCodeLine{00349       \{}
\DoxyCodeLine{00350         m\_pinCoil1.setLow();}
\DoxyCodeLine{00351         m\_pinCoil2.setHigh();}
\DoxyCodeLine{00352         m\_pinCoil3.setHigh();}
\DoxyCodeLine{00353         m\_pinCoil4.setLow();}
\DoxyCodeLine{00354         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00355       \}}
\DoxyCodeLine{00356       \textcolor{keywordflow}{case} 4:    \textcolor{comment}{//0010}}
\DoxyCodeLine{00357       \{}
\DoxyCodeLine{00358         m\_pinCoil1.setLow();}
\DoxyCodeLine{00359         m\_pinCoil2.setLow();}
\DoxyCodeLine{00360         m\_pinCoil3.setHigh();}
\DoxyCodeLine{00361         m\_pinCoil4.setLow();}
\DoxyCodeLine{00362         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00363       \}}
\DoxyCodeLine{00364       \textcolor{keywordflow}{case} 5:    \textcolor{comment}{//0011}}
\DoxyCodeLine{00365       \{}
\DoxyCodeLine{00366         m\_pinCoil1.setLow();}
\DoxyCodeLine{00367         m\_pinCoil2.setLow();}
\DoxyCodeLine{00368         m\_pinCoil3.setHigh();}
\DoxyCodeLine{00369         m\_pinCoil4.setHigh();}
\DoxyCodeLine{00370         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00371       \}}
\DoxyCodeLine{00372       \textcolor{keywordflow}{case} 6:    \textcolor{comment}{//0001}}
\DoxyCodeLine{00373       \{}
\DoxyCodeLine{00374         m\_pinCoil1.setLow();}
\DoxyCodeLine{00375         m\_pinCoil2.setLow();}
\DoxyCodeLine{00376         m\_pinCoil3.setLow();}
\DoxyCodeLine{00377         m\_pinCoil4.setHigh();}
\DoxyCodeLine{00378         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00379       \}}
\DoxyCodeLine{00380       \textcolor{keywordflow}{case} 7:    \textcolor{comment}{//1001}}
\DoxyCodeLine{00381       \{}
\DoxyCodeLine{00382         m\_pinCoil1.setHigh();}
\DoxyCodeLine{00383         m\_pinCoil2.setLow();}
\DoxyCodeLine{00384         m\_pinCoil3.setLow();}
\DoxyCodeLine{00385         m\_pinCoil4.setHigh();}
\DoxyCodeLine{00386         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00387       \}}
\DoxyCodeLine{00388     \}}
\DoxyCodeLine{00389 }
\DoxyCodeLine{00390 }
\DoxyCodeLine{00391 \}}
\DoxyCodeLine{00392 }
\DoxyCodeLine{00393 }
\DoxyCodeLine{00394 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00395}\mbox{\hyperlink{classcomponent_1_1StepperMotor_a55242f33c09a8b816fac53119b16faf4}{00395}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classcomponent_1_1StepperMotor_a55242f33c09a8b816fac53119b16faf4}{component::StepperMotor::stepDelay}}(uint8\_t a\_stepDelay)}
\DoxyCodeLine{00396 \{}
\DoxyCodeLine{00397     \textcolor{keywordflow}{while}(a\_stepDelay-\/-\/)}
\DoxyCodeLine{00398     \{}
\DoxyCodeLine{00399         \_delay\_ms(1);}
\DoxyCodeLine{00400     \}}
\DoxyCodeLine{00401 \}}
\DoxyCodeLine{00402 }
\DoxyCodeLine{\Hypertarget{StepperMotor_8cpp_source_l00403}\mbox{\hyperlink{classcomponent_1_1StepperMotor_ad09e197b7d89991ff41d93d1e579b5b9}{00403}} uint8\_t \mbox{\hyperlink{classcomponent_1_1StepperMotor_ad09e197b7d89991ff41d93d1e579b5b9}{component::StepperMotor::goalReached}}()}
\DoxyCodeLine{00404 \{}
\DoxyCodeLine{00405     \textcolor{keywordflow}{return} m\_goalReached;}
\DoxyCodeLine{00406 }
\DoxyCodeLine{00407 \}}

\end{DoxyCode}
